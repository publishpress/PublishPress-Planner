!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=1)}([,function(e,t,a){"use strict";function n(e){var t;e.icon&&(t=React.createElement("span",{className:"dashicons dashicons-"+e.icon}));var a="publishpress-calendar-button "+(e.className||"");return React.createElement("a",{href:e.href||"#",className:a,onClick:e.onClick},t,e.label)}function r(e){return React.createElement("div",{className:"publishpress-calendar-navigation-bar"},React.createElement(n,{icon:"update-alt",onClick:e.refreshOnClickCallback}),React.createElement(n,{label:"«",onClick:e.backPageOnClickCallback}),React.createElement(n,{label:"‹",onClick:e.backOnClickCallback}),React.createElement(n,{label:e.strings.today,onClick:e.todayOnClickCallback}),React.createElement(n,{label:"›",onClick:e.forwardOnClickCallback}),React.createElement(n,{label:"»",onClick:e.forwardPageOnClickCallback}))}function l(e){for(var t=[e.strings.weekDaySun,e.strings.weekDayMon,e.strings.weekDayTue,e.strings.weekDayWed,e.strings.weekDayThu,e.strings.weekDayFri,e.strings.weekDaySat],a=[],n=(e.weekStartsOnSunday?0:1)-1,r=0;r<7;r++)n++,6!==r||e.weekStartsOnSunday||(n=0),a.push({key:n.toString(),label:t[n]});return React.createElement(React.Fragment,null,a.map((function(e){return React.createElement("th",{key:e.key.toString()},e.label)})))}function s(e){var t=e.showSpinner||!1,a=e.message||"";return React.createElement("div",{className:"publishpress-calendar-message-bar"},t&&React.createElement("span",{className:"dashicons dashicons-update-alt publishpress-spinner"}),React.createElement("span",null,a))}function i(e,t,a,n,r,l,s){try{var i=e[l](s),c=i.value}catch(e){return void a(e)}i.done?t(c):Promise.resolve(c).then(n,r)}function c(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var l=e.apply(t,a);function s(e){i(l,n,r,s,c,"next",e)}function c(e){i(l,n,r,s,c,"throw",e)}s(void 0)}))}}function o(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=new Date(t,0,1+7*(e-1)),r=n.getDay(),l=n;return r<=4?l.setDate(n.getDate()-n.getDay()+1):l.setDate(n.getDate()+8-n.getDay()),a&&l.setDate(l.getDate()-1),l}function u(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n=a.getDay();a.setDate(a.getDate()+4-(a.getDay()||7));var r=new Date(a.getFullYear(),0,1),l=Math.round(((a-r)/864e5+1)/7);return t&&0===n&&l++,[a.getFullYear(),l]}function p(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=u(e,t);return o(a[1],a[0],t)}function d(e){return e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")}function m(e,t){return e.url?React.createElement("a",{href:e.url},e.label):e.action?React.createElement("a",{href:"javascript:void(0);",onClick:function(a){return t(a,e)}},e.label):void 0}function f(e,t,a){return h.apply(this,arguments)}function h(){return(h=c(regeneratorRuntime.mark((function e(t,a,n){var r,l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n+"?action="+t,e.t0=regeneratorRuntime.keys(a);case 2:if((e.t1=e.t0()).done){e.next=9;break}if(l=e.t1.value,a.hasOwnProperty(l)){e.next=6;break}return e.abrupt("continue",2);case 6:r+="&"+l+"="+a[l],e.next=2;break;case 9:return e.next=11,fetch(r);case 11:return s=e.sent,e.next=14,s.json();case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=c(regeneratorRuntime.mark((function e(t,a,n,r){var l,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=n+"?action="+t,e.t0=regeneratorRuntime.keys(a);case 2:if((e.t1=e.t0()).done){e.next=9;break}if(s=e.t1.value,a.hasOwnProperty(s)){e.next=6;break}return e.abrupt("continue",2);case 6:l+="&"+s+"="+a[s],e.next=2;break;case 9:return e.next=11,fetch(l,{method:"post",body:r});case 11:return i=e.sent,e.next=14,i.json();case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return new Date(String(e).replace(/-/g,"/"))}function v(e){return e.isEditing?React.createElement("input",{type:"text",id:e.id,value:e.value,onChange:function(t){e.onChange&&e.onChange(t,t.target.value)}}):React.createElement("time",{dateTime:e.value,title:e.value,id:e.id},e.valueString||e.value)}a.r(t);var y=jQuery;function E(e){var t,a=React.useRef(null);React.useEffect((function(){var t={placeholder:e.placeholder||!1,tags:!0,allowClear:void 0===e.allowClear||null===e.allowClear||e.allowClear};return e.ajaxUrl&&(t.ajax={delay:250,url:e.ajaxUrl,dataType:"json",data:function(t){var a={q:t.term,action:e.ajaxAction,nonce:e.nonce};if(e.ajaxArgs)for(var n in e.ajaxArgs)e.ajaxArgs.hasOwnProperty(n)&&(a[n]=e.ajaxArgs[n]);return a},processResults:function(e){return{results:e}}}),y(a.current).pp_select2(t).on("select2:select",(function(t){"function"==typeof e.onSelect&&e.onSelect(t,a.current,y(a.current).pp_select2("data"))})).on("select2:clear",(function(t){"function"==typeof e.onClear&&e.onClear(t,a.current)})),function(){y(a.current).pp_select2("destroy")}}),[]),e.options&&(t=e.options.map((function(t){return React.createElement("option",{value:t.value,selected:t.value===e.value},t.text)})));var n="pp_select2";return e.className&&(n+=" "+e.className),React.createElement("select",{className:n,id:e.id,multiple:e.multiple,ref:a},e.placeholder?React.createElement("option",{value:""},e.placeholder):React.createElement(React.Fragment,null),t)}function R(e){return e.isEditing?React.createElement(E,{ajaxUrl:e.ajaxUrl,nonce:e.nonce,multiple:e.multiple,ajaxAction:"publishpress_calendar_search_authors",value:e.value,name:e.name,id:e.id,onSelect:e.onSelect,onClear:e.onClear}):React.createElement("span",{id:e.id},e.value.join(", "))}function C(e){return e.isEditing?React.createElement("input",{type:"text",value:e.value}):React.createElement("span",null,e.value)}function k(e){return e.isEditing?React.createElement(E,{options:e.options,id:e.id,value:e.value,allowClear:e.allowClear,onSelect:e.onSelect,onClear:e.onClear}):React.createElement("span",{id:e.id},e.value)}function w(e){return e.isEditing?React.createElement(E,{placeholder:e.placeholder,id:e.id,ajaxUrl:e.ajaxUrl,nonce:e.nonce,ajaxAction:"publishpress_calendar_search_terms",ajaxArgs:{taxonomy:e.taxonomy},value:e.value,multiple:e.multiple,onSelect:e.onSelect,onClear:e.onClear,className:e.className}):void 0===e.value||0===e.value.length?React.createElement("span",{id:e.id,className:"publishpress-calendar-empty-value"},publishpressCalendarParams.strings.noTerms):React.createElement("span",{id:e.id},e.value.join(", "))}function S(e){return e.isEditing?React.createElement("input",{type:"checkbox",id:e.id,value:"1",checked:"Yes"===e.value}):"Yes"===e.value?React.createElement("span",{id:e.id,className:"dashicons dashicons-yes-alt"}):React.createElement("span",{id:e.id,className:"dashicons dashicons-no-alt"})}function x(e){return e.isEditing?React.createElement("input",{type:"location",id:e.id,value:e.value,onChange:function(t){e.onChange&&e.onChange(t,t.target.value)}}):React.createElement("span",{id:e.id},e.value)}function D(e){return e.isEditing?React.createElement("textarea",{id:e.id,onChange:function(t){e.onChange&&e.onChange(t,t.target.value)}},e.value):React.createElement("div",{id:e.id},e.value)}function j(e){return e.isEditing?React.createElement("input",{type:"text",id:e.id,value:e.value,onChange:function(t){e.onChange&&e.onChange(t,t.target.value)}}):React.createElement("span",{id:e.id},e.value)}function T(e){return e.isEditing?React.createElement("input",{type:"text",id:e.id,value:e.value}):React.createElement("span",{id:e.id},e.value)}function O(e){var t;return e.isEditing?React.createElement("input",{type:"number",value:e.value,id:e.id,onChange:function(t){e.onChange&&e.onChange(t,t.target.value)}}):(t=0===e.value?"publishpress-calendar-empty-value":"",React.createElement("span",{id:e.id,className:t},e.value))}function A(e){return React.useEffect((function(){var t="#"+e.id,a={regex:"^([0][0-9]|[1][0-9]|[2][0-3]):[0-5][0-9]$",showMaskOnHover:!1,staticDefinitionSymbol:"*"};e.placeholder&&(a.placeholder=e.placeholder),jQuery(t).inputmask(a),jQuery(t).on("change",(function(t){e.onChange&&e.onChange(t,t.target.value)}))})),e.isEditing?React.createElement("input",{type:"text",id:e.id,placeholder:e.placeholder||null,value:e.value}):React.createElement("span",{id:e.id},e.value)}var P=jQuery;function _(e){if(!e.data)return React.createElement(React.Fragment,null);if(!e.target.current)return React.createElement(React.Fragment,null);var t=P(e.target.current).position(),a=P(e.target.current).offset(),n=P(e.target.current).width(),r=t.top,l=a.left+380+10+180>=P(document).width()?t.left-25-380:t.left+n+10,s=function(t,a){t.preventDefault(),f(a.action,a.args,e.ajaxUrl).then((function(t){e.onItemActionClickCallback(a.action,e.id,t)}))};return React.createElement("div",{className:"publishpress-calendar-popup",style:{top:r,left:l}},React.createElement("div",{className:"publishpress-calendar-popup-title",style:{backgroundColor:e.color}},e.icon&&React.createElement("span",{className:"dashicons "+e.icon+" publishpress-calendar-icon"}),e.title,React.createElement("span",{className:"dashicons dashicons-no publishpress-calendar-popup-close",title:e.strings.close,onClick:function(){P(document).trigger("publishpress_calendar:close_popup")}})),React.createElement("table",null,React.createElement("tbody",null,function(){var t,a,n=[];for(var r in e.data.fields)if(e.data.fields.hasOwnProperty(r)){switch((t=e.data.fields[r]).type){case"date":a=React.createElement(v,{value:t.value,valueString:t.valueString||null,isEditing:!1});break;case"time":a=React.createElement(A,{value:t.value,isEditing:!1});break;case"authors":a=React.createElement(R,{value:t.value,isEditing:!1});break;case"type":a=React.createElement(C,{value:t.value,isEditing:!1});break;case"status":a=React.createElement(k,{value:t.value,isEditing:!1});break;case"taxonomy":a=React.createElement(w,{value:t.value,isEditing:!1});break;case"checkbox":a=React.createElement(S,{value:t.value,isEditing:!1});break;case"location":a=React.createElement(x,{value:t.value,isEditing:!1});break;case"paragraph":a=React.createElement(D,{value:t.value,isEditing:!1});break;case"text":a=React.createElement(j,{value:t.value,isEditing:!1});break;case"user":a=React.createElement(T,{value:t.value,isEditing:!1});break;case"number":a=React.createElement(O,{value:t.value,isEditing:!1});break;default:a=null}n.push(React.createElement("tr",null,React.createElement("th",null,t.label,":"),React.createElement("td",null,a)))}return n}())),React.createElement("hr",null),React.createElement("div",{className:"publishpress-calendar-popup-links"},function(){var t,a=[];for(var n in e.data.links)e.data.links.hasOwnProperty(n)&&((t=e.data.links[n]).url?a.push(React.createElement("a",{href:t.url},t.label)):t.action&&a.push(React.createElement("a",{href:"javascript:void(0);",onClick:function(e){return s(e,t)}},t.label)),a.push(React.createElement("span",null,"|")));return a.pop(),a}()))}var N=jQuery;function I(e){var t,a=e.strings.untitled,n=React.useRef(null),r=e.showIcon&&e.icon?React.createElement("span",{className:"dashicons "+e.icon}," "):null,l=e.showTime?React.createElement("time",{className:"publishpress-calendar-item-time",dateTime:e.timestamp,title:e.timestamp},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ga",a=e.getHours();return"ga"===t||"ha"===t?0===a?a="12am":a<12?("ha"===t&&(a=a.toString().padStart(2,"0")),a+="am"):(a>12&&(a-=12),"ha"===t&&(a=a.toString().padStart(2,"0")),a+="pm"):a=a.toString().padStart(2,"0"),a}(b(e.timestamp),e.timeFormat||"g:i a")):null,s=e.label||a;return React.createElement("li",{ref:n,className:(t="publishpress-calendar-item",e.isPopupOpened&&(t+=" publishpress-calendar-item-opened-popup"),e.canMove&&(t+=" publishpress-calendar-item-movable"),t),style:{backgroundColor:e.color},"data-index":e.index,"data-id":e.id,"data-datetime":e.timestamp,onClick:function(t){var a;(a=t.target,N(a).hasClass("publishpress-calendar-popup")||N(a).parents(".publishpress-calendar-popup").length>0)||e.onClickItemCallback(e.id)}},r,l,s,e.isPopupOpened&&React.createElement(_,{target:n,id:e.id,title:s,icon:e.icon,timestamp:e.timestamp,color:e.color,data:e.isPopupOpened?e.getPopupItemDataCallback():null,onItemActionClickCallback:e.onItemActionClickCallback,ajaxUrl:e.ajaxUrl,strings:e.strings}))}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],s=!0,i=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);s=!0);}catch(e){i=!0,r=e}finally{try{s||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function M(e){var t,a,n,r,l,s=F(React.useState(!1),2),i=s[0],c=s[1],o=0,u=function(){c(!i)},p=i||-1===e.maxVisibleItems?e.items:e.items.slice(0,e.maxVisibleItems);return React.createElement("td",{className:(n=e.date,r=e.todayDate,l=[1,2,3,4,5].indexOf(n.getDay())>=0?"business-day":"weekend-day",r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()&&r.getDate()===n.getDate()&&(l+=" publishpress-calendar-today"),e.isLoading&&(l+=" publishpress-calendar-loading"),i&&(l+=" publishpress-calendar-uncollapse"),1===n.getDate()&&(l+=" publishpress-calendar-first-day-of-month"),e.isHovering&&(l+=" publishpress-calendar-hovering"),"publishpress-calendar-"+l),"data-year":e.date.getFullYear(),"data-month":e.date.getMonth()+1,"data-day":e.date.getDate()},React.createElement("div",null,React.createElement("div",{className:"publishpress-calendar-cell-header"},e.shouldDisplayMonthName&&React.createElement("span",{className:"publishpress-calendar-month-name"},(t=e.date.getMonth(),[(a=publishpressCalendarParams.strings).monthJan,a.monthFeb,a.monthMar,a.monthApr,a.monthMay,a.monthJun,a.monthJul,a.monthAug,a.monthSep,a.monthOct,a.monthNov,a.monthDec][t])),React.createElement("span",{className:"publishpress-calendar-date"},e.date.getDate()),e.isHovering&&React.createElement("span",{className:"publishpress-calendar-cell-click-to-add"},e.strings.clickToAdd)),React.createElement("ul",{className:"publishpress-calendar-day-items"},p.map((function(t){var a=t.id===e.openedItemId;return React.createElement(I,{key:"item-"+t.id+"-"+e.date.getTime(),icon:t.icon,color:t.color,label:t.label,id:t.id,timestamp:t.timestamp,timeFormat:e.timeFormat,showTime:t.showTime,showIcon:!0,index:o++,canMove:t.canEdit,isPopupOpened:a,getPopupItemDataCallback:e.getOpenedItemDataCallback,onClickItemCallback:e.onClickItemCallback,onItemActionClickCallback:e.onItemActionClickCallback,ajaxUrl:e.ajaxUrl,strings:e.strings})}))),function(){if(-1===e.maxVisibleItems)return React.createElement(React.Fragment,null);if(e.items.length>e.maxVisibleItems){var t=e.items.length-e.maxVisibleItems,a=i?"Hide the "+t+" last items":"Show "+t+" more",n=i?"publishpress-calendar-hide-items":"publishpress-calendar-show-more",r=i?"hidden":"visibility";return React.createElement("a",{href:"javascript:void(0);",className:n,onClick:u},React.createElement("span",{className:"dashicons dashicons-"+r})," ",a)}return React.createElement(React.Fragment,null)}()))}var G=wp.i18n._n;function W(e){for(var t=function(t,a){var n=a?a[0].id:null;e.onChange(t,n)},a=function(e,a,n){t("status",n)},n=function(e,a,n){t("category",n)},r=function(e,a,n){t("tag",n)},l=function(e,a,n){t("author",n)},s=function(e,a,n){t("postType",n)},i=function(e,a,n){t("weeks",n)},c=function(t){return G(e.strings.xWeek,e.strings.xWeeks,t,"publishpress").replace("%d",t)},o=c(e.numberOfWeeksToDisplay),u=[],p=1;p<=12;p++)u.push({value:p,text:c(p)});return React.createElement("div",{className:"publishpress-calendar-filter-bar"},React.createElement(E,{placeholder:e.strings.allStatuses,options:e.statuses,onSelect:a,onClear:a}),React.createElement(w,{placeholder:e.strings.allCategories,isEditing:!0,ajaxUrl:e.ajaxUrl,nonce:e.nonce,taxonomy:"category",onSelect:n,onClear:n,multiple:!1,className:"publishpress-calendar-category-filter"}),React.createElement(w,{placeholder:e.strings.allTags,isEditing:!0,ajaxUrl:e.ajaxUrl,nonce:e.nonce,taxonomy:"post_tag",onSelect:r,onClear:r,multiple:!1,className:"publishpress-calendar-tag-filter"}),React.createElement(E,{placeholder:e.strings.allAuthors,ajaxUrl:e.ajaxUrl,nonce:e.nonce,ajaxAction:"publishpress_calendar_search_authors",onSelect:l,onClear:l}),React.createElement(E,{placeholder:e.strings.allTypes,options:e.postTypes,onSelect:s,onClear:s}),React.createElement(E,{placeholder:o,options:u,onSelect:i,onClear:i}))}function V(e){return e.isEditing?React.createElement(E,{ajaxUrl:e.ajaxUrl,nonce:e.nonce,multiple:e.multiple,ajaxAction:e.ajaxAction,value:e.value,name:e.name,id:e.id,onSelect:e.onSelect,onClear:e.onClear}):React.createElement("span",{id:e.id},e.value.join(", "))}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],s=!0,i=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);s=!0);}catch(e){i=!0,r=e}finally{try{s||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||H(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){if(e){if("string"==typeof e)return L(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Q=jQuery;function $(e){var t=Y(React.useState(e.postTypes[0].value),2),a=t[0],n=t[1],r=Y(React.useState([]),2),l=r[0],s=r[1],i=Y(React.useState(!1),2),c=i[0],o=i[1],u=Y(React.useState(!1),2),p=u[0],h=u[1],b=Y(React.useState(),2),y=b[0],C=b[1],P=function(){N(),U()},_=function(){Q("#wpwrap").css("overflow","hidden")},N=function(){Q("#wpwrap").css("overflow","auto")},I=function(){M("post_type",e.postTypes[0].value),M("status","draft")},F=function(e){return void 0===window.publishpressCalendarGlobalData&&(window.publishpressCalendarGlobalData={}),void 0===window.publishpressCalendarGlobalData.formFieldsData&&(window.publishpressCalendarGlobalData.formFieldsData={}),window.publishpressCalendarGlobalData.formFieldsData.hasOwnProperty(e)?window.publishpressCalendarGlobalData.formFieldsData[e]:null},U=function(){void 0!==window.publishpressCalendarGlobalData&&void 0!==window.publishpressCalendarGlobalData.formFieldsData&&(window.publishpressCalendarGlobalData.formFieldsData=[])},M=function(e,t){!function(e,t){F(e),window.publishpressCalendarGlobalData.formFieldsData[e]=t}(e,t)},G=function(t,a){t.preventDefault(),o(!0),h(a.id),C(null),function(e,t,a,n){return g.apply(this,arguments)}(a.action,a.args,e.ajaxUrl,function(){var t=new FormData;for(var a in t.append("date",d(e.date)),t.append("nonce",e.nonce),window.publishpressCalendarGlobalData.formFieldsData)window.publishpressCalendarGlobalData.formFieldsData.hasOwnProperty(a)&&t.append(a,window.publishpressCalendarGlobalData.formFieldsData[a]);return t}()).then((function(t){"create"===a.id?(o(!1),h(null),"success"===t.status?e.onCloseCallback&&e.onCloseCallback():C(t.message)):"edit"===a.id&&("success"===t.status?window.location.href=t.data.link:(o(!1),h(null),C(t.message)))}))},W=function(){setTimeout((function(){Q(".publishpress-calendar-popup-form input").first().focus()}),500)};React.useEffect((function(){return U(),n(e.postTypes[0].value),I(),_(),P}),[]),React.useEffect((function(){o(!0);var t={nonce:e.nonce,postType:F("post_type"),date:d(e.date)};s(null),f(e.actionGetPostTypeFields,t,e.ajaxUrl).then((function(e){s(e.fields)})).then((function(){W(),o(!1)}))}),[a]);var L=function(){var t,a,n,r,s=[],i=function(i){if(!l.hasOwnProperty(i))return"continue";switch(n="publishpress-calendar-field-"+i,t=l[i],r=t.placeholder?t.placeholder:null,t.type){case"date":a=React.createElement(v,{value:t.value,isEditing:!0,id:n,onChange:function(e,t){M(i,t)}});break;case"authors":a=React.createElement(R,{value:t.value,isEditing:!0,name:i,id:n,nonce:e.nonce,ajaxUrl:e.ajaxUrl,multiple:e.allowAddingMultipleAuthors,onSelect:function(e,t,a){for(var n=[],r=0;r<a.length;r++)n.push(a[r].id);M(i,n)},onClear:function(e,t){M(i,null)}});break;case"select":a=React.createElement(V,{value:t.value,isEditing:!0,name:i,id:n,nonce:e.nonce,ajaxUrl:e.ajaxUrl,ajaxAction:t.ajaxAction,multiple:t.multiple,onSelect:function(e,t,a){for(var n=[],r=0;r<a.length;r++)n.push(a[r].id);M(i,n)},onClear:function(e,t){M(i,null)}});break;case"status":a=React.createElement(k,{value:t.value,isEditing:!0,id:n,options:t.options,onSelect:function(e,t,a){var n=null;a.length>0&&(n=a[0].id),M(i,n)},onClear:function(e,t){M(i,null)}});break;case"taxonomy":a=React.createElement(w,{value:t.value,isEditing:!0,id:n,taxonomy:t.taxonomy,nonce:e.nonce,ajaxUrl:e.ajaxUrl,multiple:!0,onSelect:function(e,t,a){for(var n=[],r=0;r<a.length;r++)n.push(a[r].id);M(i,n)},onClear:function(e,t){M(i,null)}});break;case"checkbox":a=React.createElement(S,{isEditing:!0,id:n,value:t.value});break;case"location":a=React.createElement(x,{value:t.value,isEditing:!0,id:n,onChange:function(e,t){M(i,t)}});break;case"html":a=React.createElement(D,{value:t.value,isEditing:!0,id:n,onChange:function(e,t){M(i,t)}});break;case"text":a=React.createElement(j,{value:t.value,isEditing:!0,id:n,placeholder:r,onChange:function(e,t){M(i,t)}});break;case"user":a=React.createElement(T,{value:t.value,isEditing:!0,id:n});break;case"number":a=React.createElement(O,{value:t.value,isEditing:!0,id:n,onChange:function(e,t){M(i,t)}});break;case"time":a=React.createElement(A,{value:t.value,isEditing:!0,id:n,placeholder:r,onChange:function(e,t){M(i,t)}});break;default:a=null}s.push(React.createElement("tr",null,React.createElement("th",null,React.createElement("label",{htmlFor:n},t.label,":")),React.createElement("td",null,a)))};for(var c in l)i(c);return s}();return React.createElement(React.Fragment,null,React.createElement("div",{className:"publishpress-calendar-popup-screen-lock"}),React.createElement("div",{className:"publishpress-calendar-popup publishpress-calendar-popup-form"},React.createElement("div",{className:"publishpress-calendar-popup-title"},e.postId?"":e.strings.addContentFor.replace("%s",date_i18n(e.dateFormat,e.date)),React.createElement("span",{className:"dashicons dashicons-no publishpress-calendar-popup-close",title:e.strings.close,onClick:e.onCloseCallback})),React.createElement("hr",null),React.createElement("table",null,React.createElement("tbody",null,e.postTypes.length>1&&React.createElement("tr",null,React.createElement("th",null,React.createElement("label",null,e.strings.postType)),React.createElement("td",null,React.createElement(E,{options:e.postTypes,allowClear:!1,onSelect:function(e){var t=Q(e.target).pp_select2("data")[0].id;n(t),M("post_type",t)}}))),1===e.postTypes.length&&React.createElement("tr",null,React.createElement("th",null,React.createElement("label",null,e.strings.postType)),React.createElement("td",null,function(t){var a,n=function(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=H(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,i=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){i=!0,l=e},f:function(){try{s||null==a.return||a.return()}finally{if(i)throw l}}}}(e.postTypes);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(r.value===t)return r.text}}catch(e){n.e(e)}finally{n.f()}return e.strings.postTypeNotFound}(a))),L.length>0&&L)),0===L.length&&React.createElement("div",{className:"publishpress-calendar-popup-loading-fields"},e.strings.pleaseWaitLoadingFormFields),y&&React.createElement("div",{className:"publishpress-calendar-popup-error-message"},React.createElement("span",{className:"dashicons dashicons-warning"}),y),React.createElement("hr",{className:"publishpress-calendar-popup-links-hr"}),React.createElement("div",{className:"publishpress-calendar-popup-links"},function(){var t,a=[{id:"create",label:e.strings.save,labelLoading:e.strings.saving,action:"publishpress_calendar_create_item"},{id:"edit",label:e.strings.saveAndEdit,labelLoading:e.strings.saving,action:"publishpress_calendar_create_item"}],n=[];for(var r in a)a.hasOwnProperty(r)&&(t=a[r],p===t.id?n.push(React.createElement("span",null,t.labelLoading)):n.push(m(t,G)),n.push(React.createElement("span",null,"|")));return n.pop(),n}(),c&&React.createElement("span",{className:"dashicons dashicons-update-alt publishpress-spinner"}))))}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,r,l=[],s=!0,i=!1;try{for(a=a.call(e);!(s=(n=a.next()).done)&&(l.push(n.value),!t||l.length!==t);s=!0);}catch(e){i=!0,r=e}finally{try{s||null==a.return||a.return()}finally{if(i)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return J(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return J(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var q=jQuery;function B(e){var t=e.theme||"light",a=z(React.useState(p(e.firstDateToDisplay,e.weekStartsOnSunday)),2),n=a[0],i=a[1],c=z(React.useState(e.numberOfWeeksToDisplay),2),o=c[0],u=c[1],m=z(React.useState(e.items),2),f=m[0],h=m[1],g=z(React.useState(!1),2),v=g[0],y=g[1],E=z(React.useState(!1),2),R=E[0],C=E[1],k=z(React.useState(),2),w=k[0],S=k[1],x=z(React.useState(),2),D=x[0],j=x[1],T=z(React.useState(),2),O=T[0],A=T[1],P=z(React.useState(),2),_=P[0],N=P[1],I=z(React.useState(),2),F=I[0],U=I[1],G=z(React.useState(),2),V=G[0],Y=G[1],H=z(React.useState(e.numberOfWeeksToDisplay),2),L=H[0],Q=H[1],J=z(React.useState(),2),B=J[0],K=J[1],X=z(React.useState([]),2),Z=X[0],ee=X[1],te=z(React.useState(0),2),ae=te[0],ne=te[1],re=z(React.useState(0),2),le=re[0],se=re[1],ie=z(React.useState(),2),ce=ie[0],oe=ie[1],ue=z(React.useState(),2),pe=ue[0],de=ue[1],me=function(t,a){return a||(a=""),e.ajaxUrl+"?action="+t+"&nonce="+e.nonce+a},fe=function(){document.removeEventListener("keydown",Se),q(".publishpress-calendar tbody > tr > td").off("mouseenter")},he=function(){q(".publishpress-calendar-day-hover").removeClass("publishpress-calendar-day-hover"),q(".publishpress-calendar-loading").removeClass("publishpress-calendar-loading")},ge=function(e){i(new Date(n.getTime()+7*e*24*60*60*1e3))},be=function(t,a){var n=q(t.target),r=q(a.draggable[0]),l=d(b(r.data("datetime")));q(t.target).addClass("publishpress-calendar-loading"),function(t,a,n,r,l){var s=f[t][a];y(!0),S(e.strings.movingTheItem);var i=me(e.actionMoveItem),c=new FormData;c.append("id",s.id),c.append("year",n),c.append("month",r),c.append("day",l),fetch(i,{method:"POST",body:c}).then((function(e){return e.json()})).then((function(){se(le+1)}))}(l,r.data("index"),n.data("year"),n.data("month"),n.data("day"))},ve=function(e,t){he(),q(e.target).addClass("publishpress-calendar-day-hover")},ye=function(e){var t=q(e);return t.is("td.publishpress-calendar-business-day, td.publishpress-calendar-weekend-day")?t:t.is(".publishpress-calendar-cell-header, .publishpress-calendar-date, .publishpress-calendar-cell-click-to-add, .publishpress-calendar-month-name")?t.parents("td"):null},Ee=function(e){var t=b(e.data("year")+"-"+e.data("month")+"-"+e.data("day"));return t.getHours()>0&&t.setTime(t.getTime()+6e4*t.getTimezoneOffset()),t},Re=function(){var e;q(".publishpress-calendar tbody > tr > td").on("mouseover",(function(t){t.preventDefault(),t.stopPropagation();var a=ye(t.target);if(a){if(function(e){return q(e).hasClass("publishpress-calendar-day-hover")}(a))return;oe(Ee(a)),e=Ee(a)}})).on("mouseout",(function(t){t.stopPropagation(),t.preventDefault(),ye(t.relatedTarget)||(oe(null),e=null)})).on("click",(function(t){ye(t.target)&&(K(null),de(e))}))},Ce=function(){K(null),ee(null),de(null)},ke=function(e){ee(null),oe(null),de(null),K(e)},we=function(e,t,a){ne(ae+1)},Se=function(e){"Escape"===e.key&&Ce()},xe=function(){return Z},De=function(){K(null)};React.useEffect((function(){return document.addEventListener("keydown",Se),q(document).on("publishpress_calendar:close_popup",De),e.userCanAddPosts&&Re(),fe}),[]),React.useEffect((function(){q(".publishpress-calendar-day-items li").draggable({zIndex:99999,helper:"clone",containment:".publishpress-calendar table",start:function(e,t){return q(e.target).data("id")!==B&&(!!q(e.target).hasClass("publishpress-calendar-item-movable")&&(q(e.target).addClass("ui-draggable-target"),Ce(),void C(!0)))},stop:function(e,t){q(".ui-draggable-target").removeClass("ui-draggable-target"),C(!1)}}),q(".publishpress-calendar tbody > tr > td").droppable({drop:be,over:ve})})),e.userCanAddPosts&&React.useEffect(Re,[n,o,L,F,_,O,D,V,le]),React.useEffect((function(){y(!0),S(e.strings.loading);var t=me(e.actionGetData,"&start_date="+d(p(n,e.weekStartsOnSunday))+"&number_of_weeks="+o);D&&(t+="&post_status="+D),O&&(t+="&category="+O),_&&(t+="&post_tag="+_),F&&(t+="&post_author="+F),V&&(t+="&post_type="+V),L&&(t+="&weeks="+L),fetch(t).then((function(e){return e.json()})).then((function(e){h(e),y(!1),S(null),he()}))}),[n,o,L,F,_,O,D,V,le]),React.useEffect((function(){if(B){y(!0),S(e.strings.loadingItem);var t=e.ajaxUrl+"?action=publishpress_calendar_get_post_data&nonce="+e.nonce+"&id="+B;fetch(t).then((function(e){return e.json()})).then((function(e){y(!1),S(null),ee(e)}))}}),[B,ae]);var je=["publishpress-calendar","publishpress-calendar-theme-"+t];return e.userCanAddPosts&&je.push("user-can-add-posts"),React.createElement("div",{className:je.join(" ")},React.createElement(W,{statuses:e.statuses,postTypes:e.postTypes,numberOfWeeksToDisplay:o,ajaxUrl:e.ajaxUrl,nonce:e.nonce,onChange:function(t,a){"status"===t&&j(a),"category"===t&&A(a),"tag"===t&&N(a),"author"===t&&U(a),"postType"===t&&Y(a),"weeks"===t&&((0===(a=parseInt(a))||isNaN(a))&&(a=e.numberOfWeeksToDisplay),Q(a),u(a))},strings:e.strings}),React.createElement(r,{refreshOnClickCallback:function(e){e.preventDefault(),se(le+1)},backPageOnClickCallback:function(e){e.preventDefault(),ge(-1*o)},backOnClickCallback:function(e){e.preventDefault(),ge(-1)},forwardOnClickCallback:function(e){e.preventDefault(),ge(1)},forwardPageOnClickCallback:function(e){e.preventDefault(),ge(o)},todayOnClickCallback:function(t){t.preventDefault(),i(p(e.todayDate,e.weekStartsOnSunday))},strings:e.strings}),React.createElement("table",null,React.createElement("thead",null,React.createElement("tr",null,React.createElement(l,{weekStartsOnSunday:e.weekStartsOnSunday,strings:e.strings}))),React.createElement("tbody",null,function(){for(var t,a,r=7*o,l=p(n,e.weekStartsOnSunday),s=[],i=[],c=0,u=l.getMonth(),m=0;m<r;m++)0===c&&(i=[]),(t=new Date(l)).setDate(t.getDate()+m),a=d(t),i.push(React.createElement(M,{key:"day-"+t.getTime(),date:t,shouldDisplayMonthName:u!==t.getMonth()||0===m,todayDate:e.todayDate,isLoading:!1,isHovering:!R&&ce&&ce.getTime()===t.getTime()&&!pe,items:f[a]||[],maxVisibleItems:parseInt(e.maxVisibleItems),timeFormat:e.timeFormat,openedItemId:B,getOpenedItemDataCallback:xe,ajaxUrl:e.ajaxUrl,onClickItemCallback:ke,onItemActionClickCallback:we,strings:e.strings})),7===++c&&(c=0,s.push(React.createElement("tr",null,i))),u=t.getMonth();return s}())),pe&&React.createElement($,{date:pe,ajaxUrl:e.ajaxUrl,dateFormat:e.dateFormat,postTypes:e.postTypesCanCreate,statuses:e.statuses,actionGetPostTypeFields:e.actionGetPostTypeFields,nonce:e.nonce,onCloseCallback:function(){se(le+1),de(null)},allowAddingMultipleAuthors:e.allowAddingMultipleAuthors,strings:e.strings}),React.createElement(s,{showSpinner:v,message:w}))}jQuery((function(){var e,t,a;ReactDOM.render(React.createElement(B,{firstDateToDisplay:(e=publishpressCalendarParams.firstDateToDisplay,t=new Date(e),a=6e4*t.getTimezoneOffset(),new Date(t.getTime()+a)),weekStartsOnSunday:1===parseInt(publishpressCalendarParams.weekStartsOnSunday),numberOfWeeksToDisplay:publishpressCalendarParams.numberOfWeeksToDisplay,todayDate:b(publishpressCalendarParams.todayDate),dateFormat:publishpressCalendarParams.dateFormat,timeFormat:publishpressCalendarParams.timeFormat,theme:publishpressCalendarParams.theme,statusesToDisplayTime:publishpressCalendarParams.statusesToDisplayTime,maxVisibleItems:publishpressCalendarParams.maxVisibleItems,ajaxUrl:publishpressCalendarParams.ajaxUrl,actionGetData:"publishpress_calendar_get_data",actionMoveItem:"publishpress_calendar_move_item",actionGetPostTypeFields:"publishpress_calendar_get_post_type_fields",nonce:publishpressCalendarParams.nonce,statuses:publishpressCalendarParams.statuses,postTypes:publishpressCalendarParams.postTypes,postTypesCanCreate:publishpressCalendarParams.postTypesCanCreate,userCanAddPosts:publishpressCalendarParams.userCanAddPosts,items:publishpressCalendarParams.items,allowAddingMultipleAuthors:publishpressCalendarParams.allowAddingMultipleAuthors,strings:publishpressCalendarParams.strings}),document.getElementById("publishpress-calendar-wrap"))}))}]);